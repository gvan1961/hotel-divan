<div class="container-relatorio">
  
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- LOADING -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Gerando relatÃ³rio detalhado...</p>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- ERRO -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div *ngIf="erro" class="erro-container">
    <div class="erro-box">
      <h3>âŒ Erro</h3>
      <p>{{ erro }}</p>
      <button (click)="voltar()" class="btn-voltar">Voltar</button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <!-- RELATÃ“RIO -->
  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div *ngIf="relatorio && !loading" class="relatorio">

    <!-- CABEÃ‡ALHO -->
    <div class="cabecalho no-print">
      <button (click)="voltar()" class="btn-voltar">
        â† Voltar
      </button>
      <h1>ğŸ“Š RelatÃ³rio Detalhado de Caixa</h1>
      <div class="acoes">
        <button (click)="imprimir()" class="btn-imprimir">
          ğŸ–¨ï¸ Imprimir
        </button>
        <button (click)="exportarPDF()" class="btn-pdf">
          ğŸ“„ PDF
        </button>
      </div>
    </div>

    <!-- INFORMAÃ‡Ã•ES DO CAIXA -->
    <div class="info-caixa">
      <div class="info-item">
        <span class="label">Caixa:</span>
        <span class="valor">#{{ relatorio.caixaId }}</span>
      </div>
      <div class="info-item">
        <span class="label">Recepcionista:</span>
        <span class="valor">{{ relatorio.recepcionistaNome }}</span>
      </div>
      <div class="info-item">
        <span class="label">Abertura:</span>
        <span class="valor">{{ formatarData(relatorio.dataHoraAbertura) }}</span>
      </div>
      <div class="info-item">
        <span class="label">Fechamento:</span>
        <span class="valor">{{ formatarData(relatorio.dataHoraFechamento) }}</span>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- VENDAS DE RESERVAS (POR APARTAMENTO) -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="secao">
      <div class="secao-header" (click)="toggleReservas()">
        <h2>ğŸ¨ VENDAS DE RESERVAS (POR APARTAMENTO)</h2>
        <span class="toggle-icon">{{ mostrarReservas ? 'â–¼' : 'â–¶' }}</span>
      </div>

      <div *ngIf="mostrarReservas" class="secao-conteudo">
        
        <!-- LISTA DE APARTAMENTOS -->
        <div *ngFor="let venda of relatorio.vendasReservas" class="apartamento-card">
          
          <!-- CABEÃ‡ALHO DO APARTAMENTO -->
          <div class="apartamento-header">
            <div class="apartamento-info">
              <h3>ğŸ  Apto {{ venda.numeroApartamento }}</h3>
              <p class="cliente-nome">{{ venda.clienteNome }}</p>
              <p class="reserva-id">Reserva #{{ venda.reservaId }}</p>
            </div>
            <div class="apartamento-total">
              <span class="total-label">Total</span>
              <span class="total-valor">{{ formatarMoeda(venda.total) }}</span>
            </div>
          </div>

          <!-- DETALHAMENTO POR FORMA DE PAGAMENTO -->
          <div class="pagamentos-grid">
            
            <div class="pagamento-item" *ngIf="venda.pagamentos.dinheiro > 0">
              <span class="pagamento-icon">ğŸ’µ</span>
              <span class="pagamento-nome">Dinheiro</span>
              <span class="pagamento-valor">{{ formatarMoeda(venda.pagamentos.dinheiro) }}</span>
            </div>

            <div class="pagamento-item" *ngIf="venda.pagamentos.pix > 0">
              <span class="pagamento-icon">ğŸ“±</span>
              <span class="pagamento-nome">PIX</span>
              <span class="pagamento-valor">{{ formatarMoeda(venda.pagamentos.pix) }}</span>
            </div>

            <div class="pagamento-item" *ngIf="venda.pagamentos.cartaoDebito > 0">
              <span class="pagamento-icon">ğŸ’³</span>
              <span class="pagamento-nome">C. DÃ©bito</span>
              <span class="pagamento-valor">{{ formatarMoeda(venda.pagamentos.cartaoDebito) }}</span>
            </div>

            <div class="pagamento-item" *ngIf="venda.pagamentos.cartaoCredito > 0">
              <span class="pagamento-icon">ğŸ’³</span>
              <span class="pagamento-nome">C. CrÃ©dito</span>
              <span class="pagamento-valor">{{ formatarMoeda(venda.pagamentos.cartaoCredito) }}</span>
            </div>

            <div class="pagamento-item" *ngIf="venda.pagamentos.transferencia > 0">
              <span class="pagamento-icon">ğŸ¦</span>
              <span class="pagamento-nome">TransferÃªncia</span>
              <span class="pagamento-valor">{{ formatarMoeda(venda.pagamentos.transferencia) }}</span>
            </div>

            <div class="pagamento-item" *ngIf="venda.pagamentos.faturado > 0">
              <span class="pagamento-icon">ğŸ“„</span>
              <span class="pagamento-nome">Faturado</span>
              <span class="pagamento-valor">{{ formatarMoeda(venda.pagamentos.faturado) }}</span>
            </div>

          </div>

        </div>

        <!-- SUBTOTAL RESERVAS -->
        <div class="subtotal-box">
          <h3>ğŸ“Š SUBTOTAL RESERVAS</h3>
          <div class="subtotal-grid">
            <div class="subtotal-item">
              <span>ğŸ’µ Dinheiro:</span>
              <strong>{{ formatarMoeda(relatorio.subtotalReservas.dinheiro) }}</strong>
            </div>
            <div class="subtotal-item">
              <span>ğŸ“± PIX:</span>
              <strong>{{ formatarMoeda(relatorio.subtotalReservas.pix) }}</strong>
            </div>
            <div class="subtotal-item">
              <span>ğŸ’³ C. DÃ©bito:</span>
              <strong>{{ formatarMoeda(relatorio.subtotalReservas.cartaoDebito) }}</strong>
            </div>
            <div class="subtotal-item">
              <span>ğŸ’³ C. CrÃ©dito:</span>
              <strong>{{ formatarMoeda(relatorio.subtotalReservas.cartaoCredito) }}</strong>
            </div>
            <div class="subtotal-item">
              <span>ğŸ¦ TransferÃªncia:</span>
              <strong>{{ formatarMoeda(relatorio.subtotalReservas.transferencia) }}</strong>
            </div>
            <div class="subtotal-item">
              <span>ğŸ“„ Faturado:</span>
              <strong>{{ formatarMoeda(relatorio.subtotalReservas.faturado) }}</strong>
            </div>
          </div>
          <div class="subtotal-total">
            <span>TOTAL:</span>
            <strong>{{ formatarMoeda(relatorio.subtotalReservas.total) }}</strong>
          </div>
        </div>

      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- VENDAS AVULSAS (FORA DE RESERVAS) -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="secao">
      <div class="secao-header" (click)="toggleAvulsas()">
        <h2>ğŸ›’ VENDAS AVULSAS (FORA DE RESERVAS)</h2>
        <span class="toggle-icon">{{ mostrarAvulsas ? 'â–¼' : 'â–¶' }}</span>
      </div>

      <div *ngIf="mostrarAvulsas" class="secao-conteudo">
        <div class="subtotal-grid">
          <div class="subtotal-item">
            <span>ğŸ’µ Dinheiro:</span>
            <strong>{{ formatarMoeda(relatorio.vendasAvulsas.dinheiro) }}</strong>
          </div>
          <div class="subtotal-item">
            <span>ğŸ“± PIX:</span>
            <strong>{{ formatarMoeda(relatorio.vendasAvulsas.pix) }}</strong>
          </div>
          <div class="subtotal-item">
            <span>ğŸ’³ C. DÃ©bito:</span>
            <strong>{{ formatarMoeda(relatorio.vendasAvulsas.cartaoDebito) }}</strong>
          </div>
          <div class="subtotal-item">
            <span>ğŸ’³ C. CrÃ©dito:</span>
            <strong>{{ formatarMoeda(relatorio.vendasAvulsas.cartaoCredito) }}</strong>
          </div>
          <div class="subtotal-item">
            <span>ğŸ¦ TransferÃªncia:</span>
            <strong>{{ formatarMoeda(relatorio.vendasAvulsas.transferencia) }}</strong>
          </div>
          <div class="subtotal-item">
            <span>ğŸ“„ Faturado:</span>
            <strong>{{ formatarMoeda(relatorio.vendasAvulsas.faturado) }}</strong>
          </div>
        </div>
        <div class="subtotal-total">
          <span>TOTAL:</span>
          <strong>{{ formatarMoeda(relatorio.vendasAvulsas.total) }}</strong>
        </div>
      </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <!-- RESUMO GERAL DO CAIXA -->
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div class="total-geral-box">
      <h2>ğŸ’° RESUMO GERAL DO CAIXA</h2>
      <p class="alerta-cobranca">âš ï¸ Valores a cobrar do recepcionista:</p>
      
      <div class="total-geral-grid">
        <div class="total-item destaque-dinheiro">
          <span class="total-icon">ğŸ’µ</span>
          <div class="total-info">
            <span class="total-nome">DINHEIRO</span>
            <span class="total-valor">{{ formatarMoeda(relatorio.totalGeral.dinheiro) }}</span>
          </div>
        </div>

        <div class="total-item">
          <span class="total-icon">ğŸ“±</span>
          <div class="total-info">
            <span class="total-nome">PIX</span>
            <span class="total-valor">{{ formatarMoeda(relatorio.totalGeral.pix) }}</span>
          </div>
        </div>

        <div class="total-item">
          <span class="total-icon">ğŸ’³</span>
          <div class="total-info">
            <span class="total-nome">CARTÃƒO DÃ‰BITO</span>
            <span class="total-valor">{{ formatarMoeda(relatorio.totalGeral.cartaoDebito) }}</span>
          </div>
        </div>

        <div class="total-item">
          <span class="total-icon">ğŸ’³</span>
          <div class="total-info">
            <span class="total-nome">CARTÃƒO CRÃ‰DITO</span>
            <span class="total-valor">{{ formatarMoeda(relatorio.totalGeral.cartaoCredito) }}</span>
          </div>
        </div>

        <div class="total-item">
          <span class="total-icon">ğŸ¦</span>
          <div class="total-info">
            <span class="total-nome">TRANSFERÃŠNCIA</span>
            <span class="total-valor">{{ formatarMoeda(relatorio.totalGeral.transferencia) }}</span>
          </div>
        </div>

        <div class="total-item">
          <span class="total-icon">ğŸ“„</span>
          <div class="total-info">
            <span class="total-nome">FATURADO</span>
            <span class="total-valor">{{ formatarMoeda(relatorio.totalGeral.faturado) }}</span>
          </div>
        </div>
      </div>

      <div class="total-final">
        <span>TOTAL GERAL:</span>
        <strong>{{ formatarMoeda(relatorio.totalGeral.total) }}</strong>
      </div>
    </div>

  </div>

</div>