<div class="modal-overlay" *ngIf="isVisible" (click)="fechar()">
  <div class="modal-container" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>ğŸ”„ Transferir HÃ³spede</h2>
      <button class="btn-fechar" (click)="fechar()">âœ•</button>
    </div>

    <div class="modal-body">
      <!-- INFO DO HÃ“SPEDE -->
      <div class="info-hospede" *ngIf="hospedeSelecionado">
        <h3>ğŸ‘¤ HÃ³spede a ser transferido:</h3>
        <p><strong>Nome:</strong> {{ hospedeSelecionado.cliente.nome }}</p>
        <p><strong>Apartamento Atual:</strong> {{ hospedeSelecionado.reserva.apartamento.numeroApartamento }}</p>
        <p *ngIf="hospedeSelecionado.titular" class="badge-titular">
          â˜… TITULAR DA RESERVA
        </p>
      </div>

      <!-- LOADING -->
      <div class="loading" *ngIf="carregando">
        <div class="spinner"></div>
        <p>Carregando apartamentos disponÃ­veis...</p>
      </div>

      <!-- FORMULÃRIO -->
      <div class="formulario" *ngIf="!carregando">
        <!-- APARTAMENTO DESTINO -->
        <div class="campo">
          <label>Apartamento de Destino *</label>
          <select [(ngModel)]="apartamentoDestinoId" [disabled]="apartamentosDisponiveis.length === 0">
            <option [ngValue]="null">Selecione...</option>  <!-- âœ… CORRETO -->
            <option *ngFor="let apt of apartamentosDisponiveis" [ngValue]="apt.id">
            {{ obterInfoApartamento(apt) }}
            </option>
          </select>
          <small *ngIf="apartamentosDisponiveis.length === 0" class="text-danger">
            âš ï¸ Nenhum apartamento disponÃ­vel
          </small>
        </div>

        <!-- MOTIVO -->
        <div class="campo">
          <label>Motivo da TransferÃªncia *</label>
          <textarea 
            [(ngModel)]="motivoTransferencia"
            rows="3"
            placeholder="Ex: HÃ³spede solicitou troca, problema no apartamento, etc."
            maxlength="500"></textarea>
          <small>ObrigatÃ³rio - MÃ¡ximo 500 caracteres</small>
        </div>

        <!-- EXPLICAÃ‡ÃƒO DA LÃ“GICA -->
        <div class="info-box">
          <p><strong>â„¹ï¸ Como funciona:</strong></p>
          <ul>
            <li>Se o apartamento destino estiver <strong>vazio</strong>, uma nova reserva serÃ¡ criada</li>
            <li>Se o apartamento destino jÃ¡ tiver hÃ³spedes, o hÃ³spede serÃ¡ <strong>adicionado Ã  reserva existente</strong></li>
            <li>Se este for o Ãºltimo hÃ³spede do apartamento atual, ele serÃ¡ enviado para <strong>LIMPEZA</strong></li>
            <li>Os valores serÃ£o recalculados automaticamente</li>
          </ul>
        </div>

        <!-- ERRO -->
        <div class="alert-erro" *ngIf="erro">
          âŒ {{ erro }}
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-cancelar" (click)="fechar()" [disabled]="carregando">
        Cancelar
      </button>
      <button 
        class="btn-confirmar" 
         (click)="confirmarTransferencia()" 
         [disabled]="carregando || !apartamentoDestinoId || !motivoTransferencia">
         {{ carregando ? 'Transferindo...' : 'âœ… Confirmar TransferÃªncia' }}
      </button>
    </div>
  </div>
</div>